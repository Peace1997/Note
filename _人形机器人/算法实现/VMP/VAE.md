[[_深度学习/VAE|VAE]]



##  难点分析

### 参考数据

#### 1. 数据类型是否多样化

如果参考的数据集（如 AMASS、Human3.6M、CMU Mocap）**包含动作类别多样性**（行走、跑跳、摔倒、转向、起身等），  
- 那么 VAE 有能力学习**结构化的 latent space**，形成可用于“动作迁移”或“插值”的连续表示。
- 若数据偏单一，如只包含“行走”，latent space 只覆盖该区域，生成/控制就会非常局限。
    
**影响：** 影响 latent 空间的“表达能力”


#### 2. 时序一致性与帧率

如果不同轨迹之间帧率不一致（如 102Hz、140Hz），而没有做对齐/重采样处理：  
-  同一动作在时间维度上呈现不同长度或速度，对 VAE 编码器造成干扰。

**影响：** 影响模型捕捉时间动态规律的能力  
**解决建议：** 统一为固定帧率（如 100Hz）并做时间归一化，或使用时间标量作为输入特征之一。

|问题|影响|解决方法|
|---|---|---|
|不同帧率 → 时间密度不同|动作语义混乱、latent 不可控|重采样至统一帧率|
|同样帧数代表不同时间|模型输入失语义|显式加入时间位置|
|Encoder 感受野对齐失败|学不到统一动态规律|时间对齐 + 补时间特征|
|生成时节奏错位|动作快慢不稳定|Latent 控制器中加入节奏条件|



### VAE 算法模块

#### 1. KL 散度主导 

 **问题：** 优化过程中 KL loss 常常压倒 reconstruction loss，导致编码器输出的分布退化为先验（标准高斯），潜在变量 z 不再参与动作生成。
    
**后果：** 学习不到结构化、有意义的潜在空间，动作生成质量差，控制器难以用 latent vector 控制动作。

 **解决方法：**
    - 使用 **KL annealing**（KL 权重从 0 增加到 1）
    - 使用 **β-VAE**（KL loss 加权）
    - 使用 **Free bits** 策略（为每个维度设置最低 KL 贡献）
    - 添加 **辅助任务**（如预测下一帧速度、接触、目标方向）强化 z 的可解释性

#### 2. 动作重建模糊、不连贯

**问题：** 生成动作存在拖影、不自然过渡、重复帧等现象，尤其在训练初期或潜空间设计不合理时。
    
**原因：**
- Loss 仅对末端误差敏感，忽略物理连贯性
- 解码器忽略 z，用上下文或残差预测
        
 **解决方法：**
- 使用**时序编码模型（TCN / GRU / Transformer）**
- 引入 **高频损失、速度/加速度 loss、接触点 loss**
- 加入**物理损失或运动一致性约束**（如双足落地时速度为 0）



## 问题记录


1. **VAE训练速度慢**
训练数据集的获取是通过 CPU 进行的，策略的训练是在 GPU 中，因此每次数据需要经过内存后在到 GPU 中，增加了额外的消耗。

