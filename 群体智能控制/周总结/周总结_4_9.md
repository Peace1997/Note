
- [ ] Docker 镜像的创建与迁移 & 服务器环境配置
- [ ] 导弹本体修改 & 碰撞检测
- [ ] Gym 自定义导弹环境注册
- [ ] RL算法与自定义导弹环境进行交互测试



# 总结

## 1. Docker & 服务器
此前，我在自己电脑的 Docker 环境下进行调试学习，为方便接下来的训练，将转移至服务器中进行。
由于此前运行的Container中包含了其他很多环境程序，如果要制作image导出后可能得30G。为方便环境的迁移。单独制作了一个适合协同制导的image。该image包含环境所需的一系列软件依赖包。

由于最近更换了新的服务器，需要对服务器的环境进行配置。由于服务器 Nvidia 环境尚未配置完成，因此该版本 image 并未与 Nvidia 进行适配，将在下一版本 image 进行对接。

## 2. 导弹本体修改 & 碰撞检测
由于此前 baseline 并未设计导弹的头部，因此设计了一个三角形的导弹头部，并与导弹基体进行连接。
![[box2d9.png|475]]

**终止条件判断**：
在智能体与环境进行交互过程中，需要判断智能体是否满足终止条件 `done` ：
- 导弹头部或基体与地面发生碰撞则回合结束
> 对于导弹腿部的接触，目前暂未进行考虑，后面会进行优化
- 导弹超出限定边界则回合结束

**重写碰撞检测：**
在Box2D中，使用回调函数来检测碰撞。可以创建一个继承自`ContactListener`的子类，并重写其`BeginContact`和`EndContact`方法，这两个方法会在碰撞开始和结束时自动调用。在这里主要针对导弹的头部和基体进行碰撞检测的判断。

## 3. Gym 自定义导弹环境的注册
 
对于Gym的环境注册，将自定义的导弹环境类 `One_Missile_Guidance` 进行封装：
```python
from gym.envs.registration import register
register(
    id='One_Missile_Guidance-v0',
    entry_point='env.one_missile_guidance:One_Missile_Guidance',
)
```
然后通过`env = gym.make('One_Missile_Guidance-v0')`调用即可。


 注：**Gym 中的注册和 ray 不完全兼容。因此需要使用 ray 中的 resgister 进行注册**
 
## 4. RL与自定义导弹环境的交互测试

利用 OpenAI 的 spinningup 提供的 RL 算法与环境进行交互测试
为了测试验证，先设计了简易版的 MDP：

**状态空间**：
-  导弹的位置坐标
- 导弹角度
- 导弹的线速度
- 导弹的角速度
-
**动作空间**：
- 垂直推进器（$F_E$）
- 侧向推进器（$F_L$、$F_R$）


**奖励空间：**
- 导弹的头部与目标位置周围的地面发生碰撞会获得一个较大的正奖励
- 导弹位置与目标位置接近会获得一个较小的正奖励

![[box2d10.png|400]]


**下周任务：**
- 对代码部分细节进行优化
- 继续学习Ray  & RLib，并通过RLlib实现与自定义导弹环境的交互与训练