1. 设置调整 PPO 算法网络结构，设置隐藏层神经元个数、激活函数
2. 修改 PD 控制器相关参数，重新进行训练。
------------
详细 PD 控制设计：

$$
nx= Kp_x * {\delta_{x_t}} /1000 + Kd_x * ( \delta_x - \delta_{x_{t-1}})/10
$$
$$
nz = Kp_z * {\delta_{z_t}}/1000  + Kd_z * ( \delta_z - \delta_{z_{t-1}})/10
$$
- 其中，$\delta_{x_t}$为 t 时刻目标 x 坐标和当前 x 坐标的的距离差值（单位为 m），我们期望$Kp、Kd$的输出值在[0,1]范围内即可实现对过载的有效控制，因此对距离误差项统一除以 1000，对距离误差导数项统一除以 10
- 对于过载 nx 和 nz 的值，被限定在[-1,1]之间
例如当 Kp 值为 0.5，Kd 值为 0.5 时，此时的 px、pz 距离误差变化曲线为：
![[Pasted image 20240313100146.png|475]]

![[Pasted image 20240313100211.png|475]]

--------------------

PPO 网络结构参数设置

| 网络结构参数  | 参数值                 | 备注             |
| ------- | ------------------- | -------------- |
| 网络层数    | 8 x 256 x 256 x 4   |                |
| 隐藏层激活函数 | elu                 |                |
| 输出层激活函数 | relu                | 使得输出值控制为 [0,1] |

在最近的一次训练过程中，当迭代 386 回合时（1.8M 步）出现了梯度爆炸的情况，网络模型参数变为 nan，梯度爆炸作为深度学习经常出现的问题，接下来将采用如下几种方法进行处理：
- 降低学习率
- 自定义算法模型时加入 Layer Normalization 层，对网络权重进行正则化处理
- 考虑梯度裁剪，对梯度设置一个阈值来限制梯度的范围, 防止梯度值过大

虽然出现梯度爆炸的情况，但是修改 PD 控制后整体回报值相较昨天有了明显提升提升：
![[Pasted image 20240313152640.png]]

## 明日安排
- 解决训练过程中出现的梯度爆炸的情况
