# 先导知识

## 卡尔曼滤波

它能在存在诸多不确定性情况的组合信息中估计动态系统的状态，只要是存在不确定信息的动态系统，卡尔曼滤波就可以对系统下一步要做什么做出有根据的推测。即便有噪声信息干扰，卡尔曼滤波通常也能很好的弄清楚究竟发生了什么，找出现象间不易察觉的相关性。

*尽量从所有的不确定信息中提取有价值的信息*，根据状态转换与测量的两个高斯分布的均值和方差，就可套用相应公式，预测未来，修正当下。<预估位置、速度的向量，协方差矩阵（两个随机变量的相似程度）>

**定位工作原理**：利用目标的动态信息，去掉噪声的影响，得到关于目标为自的估计，这个估计可以是对当前目标位置的估计（滤波），也可以是对将来位置的估计（预测），还可以是对过去位置的估计（插值或平滑）。卡尔曼滤波就是这样一个根据当前时刻目标的检测状态，预测估计目标下一时刻目标检测状态的一个动态迭代循环过程。 


## 扩展卡尔曼滤波



## 简述

SLAM 的后端一般分为两种处理方法，一种是以扩展卡尔曼滤波（EKF）为代表的滤波方法，一种是以图优化为代表的非线性优化方法。

***卡尔曼滤波***


*什么是图？*
顶点和边的组成的结构，记一个图为 $G=\{V，E\}$，其中 V 为顶点集，E 为边集。

当一个图中存在连接两个以上顶点的边时，称这个图为**超图**（Hyper Graph）。

*怎么把SLAM问题表示成图呢？*
SLAM的核心就是根据已有的观测数据，计算机器人的运动轨迹和地图。

*什么是图优化*
图优化本质是一个优化问题。
优化问题有三个最重要的因素：目标函数、优化变量、优化约束

*图优化任务*
- 构建图：机器人位姿为顶点，位姿间的关系作为边
- 优化图：调整机器人的位姿（顶点）来尽量满足边的约束，使得误差最小
 
 g2o是一个基于图优化的一个非常广泛的库，用来优化非线性误差函数的c++框架。

1.  选择你想要的图里的节点与边的类型，确定它们的参数化形式；
2.  往图里加入实际的节点和边；
3.  选择初值，开始迭代；
4.  每一步迭代中，计算对应于当前估计值的雅可比矩阵和海塞矩阵；
5.  求解稀疏线性方程𝐻𝑘Δ𝑥=−𝑏𝑘HkΔx=−bk，得到梯度方向；
6.  继续用 GN 或 LM 进行迭代。如果迭代结束，返回优化值。
   
实际上，g2o能帮你做好第3-6步，你要做的只是前两步而已

## 非线性最小二乘法


Slam 中的图优化的环节, 本质上实际是一个非线性最小二乘问题的求解过程

以误差的平方和最小为准则来估计非线性静态模型参数的一种参数估计方法。**求多元函数极值**，这就是最小二乘法的思想！

求极值的方法：**就是求偏导，然后使偏导为 0**，遍历所有的极值点，找到最小的作为最优解。这就是最小二乘法整个的方法。


梯度下降的方法是，根据当前点，沿该点梯度方向寻找最低点，要注意学习率的设置。