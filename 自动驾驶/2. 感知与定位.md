
# 一、环境感知

## 1. 概述

### 任务：

环境感知通过各类传感器采集周边和自身的信息，实时发送给处理器，形成对周边环境的认知模型，而且需要保证在行驶过程中对环境信息进行获取并处理过程的连续性和实时性。

### 传感器类型及作用：

- **激光雷达**：远程扫描，对周围环境的三维空间完成了 60%~75%的环境信息获取；

>由于激光发散度极小，可以远距离传播，激光雷达按光源数量的不同，分成单线激光雷达和多线激光雷达，多线激光雷达不仅可以测量物体的距离，还可以扫描出障碍物的三维尺寸。

- **相机**：对周围环境进行拍照以获得环境的图像信息。

> 主要分为单目相机、双目相机、全景相机；为了适应无人车上天气变化，车体震动等造成的干扰，相机需要经过车规级的设计和测试。
> 双目相机由于在运动的无人车上成像精度不高，并没有被广泛应用；全景相机是利用多台相机同时拍照，在经过图像处理合成环境图景，常用于做目标识别。

- **毫米波雷达**：具有全天候全天候的特点，可以在干扰环境下对环境感知。

> 毫米波兼具微波致导和光电制导的优点，毫米波导引头具有体积小、质量轻和空间分辨率高的特点，能穿透雾、烟、灰尘。




# 二、 车辆定位

## 2. 概述

### 任务

利用车辆的硬件测量结果（IMU、LiDAR、IMU），结合地图软件输入比对得到车辆位置的过程。

### 传感器类型

- **GPS & RTK**：GPS 确定无人车在地球上具体位置，结合载波相位差分技术（Real Time Kinematic，RTK）可以达到厘米级精度。

- **IMU**：测量物体三轴姿态角（角速率）以及加速度的装置。

> 陀螺仪和加速度计作为主要元件，其精度直接影响惯性系统的精度，由于误差累积的缺点，需要利用外部信息进行辅助，实现组合导航，使其有效的减少随时间积累的问题。

高精细地图：高精度、精细化定义的地图。

> 高精度：包含大量行车辅助信息，最主要的是对路网精确的三维表征（厘米级），有了这些信息，通过对比车载传感器来精确地**确认当前地位置**。
> 精细化：格式化存储交通场景中的各种交通要素（道路网数据、车道网络数据、车道线、交通标志）

高精地图可以提高无人驾驶车发现并鉴别障碍物地速度和精度。

### 定位模式
#### GPS

GPS 定位的原理是：测量地面 GPS 接收器到已知位置的卫星的距离，然后接收器通过与至少 4 颗卫星通信，计算与这些卫星间的距离，就能确定其在地球上的具体位置。



#### RTK
载波相位差分技术

实时处理两个测量站载波相位观测量的差分方法。

> 实时地提供测站点在指定坐标系中地三维定位结果，并达到厘米级精度。

#### MSF
多传感器融合定位

多种传感器可以采集不同形式的数据，用于生成不同类型的和不同权重的参数，从而可以避免单一定位方法的缺陷，获得更加准确的定位结果。


#### AMCL
基于蒙特卡洛定位算法，集成于ROS操作系统的navigation导航包，用于获取机器人在世界坐标系下相对准确的坐标。

*为什么需要 AMCL？*

里程计odom会有累积误差，随着机器人不断运动，这这个误差会不断进行叠加。
陀螺仪是基于积分型的，也会有误差。

![500](img/amcl2.png)

*AMCL 获得了机器人坐标后，如何传给用于导航的 move_base ？*

AMCL 获取机器人坐标后，发布一个关于 odom---map 的两个坐标系的 TF 坐标变换。

>odom 指里程计的坐标系，这个坐标系在小车启动底盘的时候建立（即以小车的起点为原点）
>map指的是全局坐标系---global map。global map同样是在机器人启动的时候建立的，开始时map坐标系的方向跟odom一致，但随着机器人不断运动，由于里程计的误差，会使得odom和map坐标系的原点不重合。那这时如何修正呢？发布一个odom----map的TF坐标变换即可。