
# 一、简述

在卷积神经网络中，卷积核是一个过滤器（filters），逐行逐元素的进行乘法和加法运算。

*为什么需要卷积处理？*

例如图像的数据通常是三维的，空间中像素之间通常存在一定的关联，而传统的神经网络（全连接层）通常只会处理一维的数据，从而忽视多维数据的形状和数据间联系（特征），因此需要卷积运算来处理多维空间数据，从而更好的从整个图像中提取有效特征。



因此，**通过卷积核提取图像的局部特征**，生成一个个神经元，再经过深层的连接，就构建出了卷积神经网络。


> 在卷积核的标准定义是两个函数在反转和移位后的乘积的积分
> 神经元只对有限区域的感受野上的刺激物做出反应，不同的感受野可以重叠，


借鉴于视觉皮层对刺激的反应，在图像处理中，我们希望尽可能多的获得图片信息，因此需要通过不同的神经元提取图片的不同的信息，高级别的神经元可以获取低级别神经元的？？？

*卷积核的结构是怎样的？*

一个卷积核一般包括：核大小、步长以及填充步数
- **核大小**（Kernel Size）：提取图像信息的大小；卷积核越大，感受野越大，看到的信息越多，从而可以获得更多的全局特征，但是大的卷积核也是会增加计算量，二维卷积核最常见的是 3* 3 的卷积核。对于三维卷积，深度与输入图像深度有关。
- **步长**（Stride）：提取图片信息的精度；每次卷积跨越的长度，步长越小，相邻感受野之间重复区域越多，图片信息提取的约精准，更有效的利用原图信息。
- **填充**（Padding）：解决卷积核于图像尺寸不匹配的问题；例如卷积后图片和卷积前的图片尺寸不一致（变小），因此需要对原始图片做边界填充处理。



这次处理图像是单通道的图像，**通道数**：就是二维矩阵图的数量
![400](img/filter1.gif)
再这里核大小为 3* 3 的矩阵，步长是 1，填充为 0，再每个位置（最终输出），都再进行逐元素的乘法和加法。每个滑动位置以一个数字结尾，最终输出为 3x3 矩阵。



*多通道图像如何处理*

最常见的多通道图像就是彩色照片（RGB 三通道）

![500](img/filters2.gif)
**分散计算**：在这里输入层是一个 3x5x5 矩阵，有 3 个通道，卷积核是一个 3x3x3 的矩阵，计算时按通道进行输入数据与滤波器的卷积运算（转换为单通道卷积），即执行三次卷积操作，产生 3 个尺寸为 3x3 的通道（3x3x3）。
**逐个相加**：将逐个三个通道逐个元素相加，最终形成一个单个通道（1x3x3）

> 上图用一个三维小方格表示单个数据。



*图像输入输出通道数的影响因素？*

- 输入矩阵的通道数（C）决定卷积核的通道数
- 卷积核的个数（FN）决定输出矩阵的通道数

![卷积运算的处理流（批处理+偏置）- 方块表示三维数据](img/conv3.png)



*什么是 2D 卷积？*

2D 卷积就是，卷积运算是在二维空间上（H，W）滑动，因此2D卷积关注图像二维空间特征，一次计算输出的也是二维数据
使用 Dout 个 filters，将深度为 Din 的层映射为另一个深度为 Dout 的层；

> 虽然有输入数据和卷积核都有多个通道（C），但是进行卷积运算时，他们是按照通道分开计算的，因此本质是一次卷积运算还是在二维空间中进行的，因此计算后的数据也是一个二维数据。
> 同理多个卷积核（FN）也是独立计算在拼接的。


**计算公式**：

超参数: 
一
输入数据维度 $C*W*H$、卷积核个数 $FN$, 卷积核维度 $C*FH * FW$, 步长 $S$, 填充 $p$，输出数据维度$FN*OH*OW$

参数量：(C* FH* FW +1) * FN    （卷积核维度+偏置维度）

$$  
\begin{aligned} O H &=\frac{H+2 P-F H}{S}+1 \\ O W &=\frac{W+2 P-F W}{S}+1 \end{aligned}  
$$

*什么是 3 维卷积？*

3D卷积需要在三个维度上（C，H，W）滑动，关注的三维空间特征，一次计算输出三维空间特征。相较于2维卷积通道之间独立计算，3维卷积可以考虑不同通道之间的数据联系。


参考：
- [[深度学习入门#7.1 卷积层]]
- [卷积核的基本概况][https://mp.weixin.qq.com/s?__biz=Mzg4NTUzNzE5OQ==&mid=2247525251&idx=1&sn=bbdae1638eada15e42ea0c3e2e70404f&chksm=cfa54343f8d2ca55de7fb85f9e1c8f61b595c0e2d0815a1b34a4323b9bd68896b5d7534d8f35&mpshare=1&scene=1&srcid=1008L34zkCFIdqcg5mA9E5sU&sharer_sharetime=1666363714914&sharer_shareid=ba65af19e5335584b01fe826337afabc#rd]