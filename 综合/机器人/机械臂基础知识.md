
## 一、位姿

位姿 = 位置（3dim）+姿态（3dim）；任何一个刚体在空间坐标系(OXYZ)中可以用位姿来精确、**唯一**表示其位置状态。位姿是**相对**的。

### 位置
在三维空间中用笛卡尔坐标系位置坐标 X Y Z 表示。

### 姿态
三维空间中用 R（roll 翻滚角）P（pitch 俯仰角）Y（yaw 偏航角度）来表示关节点按 X轴、Y轴、Z轴旋转。

### 四元数
四元数(Quaternion)用来表示机械臂末端执行器(如机器人手腕)的姿态(Orientation)。
它由4个元素组成:(q_w, q_x, q_y, q_z)
- q_w: 代表四元数的标量部分 (scalar part),表示旋转角度的余弦值的一半,即q_w = cos(θ/2)。其中θ是四元数表示的旋转角度
- q_x, q_y, q_z: 代表四元数的向量部分(vector part),对应于x,y,z三个坐标轴的分量。

四元数本身就是一个四维数学对象,它可以看作是一个四维空间中的单位向量和一个旋转角度。四元数表示的旋转,不需要指定固定的旋转轴,而是在四维空间中绕一个任意轴进行旋转。给定(q_w, q_x, q_y, q_z)就可以唯一确定一个旋转。
> 当俯仰角(pitch)接近±90度时,会导致其他两个角度(roll 和 yaw)表示重合、失去一个自由度,出现"万向节死锁"。这是因为欧拉角仅仅只是变换不描述运动，而且它的变换是存在顺序的，当旋转 90 度后再运动此时不是基于当前的运动状态进行变化而是基于初始的状态。


使用四元组而不是欧拉角或旋转矩阵来表示姿态的主要**优势**是:
1. 避免了陀螺仪旋转导致的"万向节锁死"问题（使用欧拉角表示三维旋转时,需要绕固定的X、Y、Z三个坐标轴进行旋转。当其中两个轴重合时,就会失去一个旋转自由度,从而出现万向节锁死的情况。）
2. 使用四元数进行插值可以获得平滑的姿态变换
3. 四元数进行旋转运算比矩阵运算更加高效

## 二、运动学（Kinematics）
专门用于描述物体的运动，研究的是运动的本身，主要表述物体的速度、加速度（关节空间）和空间位置（操作空间）这几个量之间的关系。运动学不涉及物体的质量，也就不涉及力。

### 正运动学
根据关节空间的关节向量，求解操作空间（末端执行器）的位姿。

`T = fkine(q)`：
-   输入：各个关节角度值(转角值；theta；1XN)
-   输出：机器人末端的齐次变换矩阵，即末端位姿。
> 关节空间：关节位置向量
> 操作空间：末端执行器的位置/朝向

### 逆运动学
已知操纵空间的位姿，求解关节空间的关节向量。

`q = ikine(T)`:
-   输入：给定末端姿态
-   输出：各个关节角度值



## 三、动力学（Dynamics）

考虑了物体的质量，研究由于力的作用，物理系统怎么变化；主要研究了运动变化与造成这种变化的各种因素。

### 运动学和动力学
运动学纯粹描述物体的运动，不考虑导致运动的因素。在设计初期，研究关键零部件的**运动轨迹、速度**满足相应要求时，可以用运动学就可以；当研究如何使机器按照相应速度、加速度平稳的运行起来，涉及到**控制**时，就需要动力学分析。

### 正动力学
已知机器人的关节力矩和上一时刻的运动状态（角度和角速度），计算得到下一时刻的的运动加速度，在通过积分的方法得到速度、角度。

### 逆动力学
已知某一时刻的机器人各关节的位置、关节速度、关节加速度，求此时施在机器人各关节的力矩

## 四、 几何关系描述

### T 矩阵法

T 矩阵法为机械臂最基本的建系方法。是通过关节的 6 个维度的位姿信息来表示两个坐标系之间的齐次变换矩阵（Homogenous Transformation Matrix），通过矩阵相乘的形式对各个坐标系间的映射关系（Mapping）。

例如 $H_{i}^{i-1}$ 表示坐标系 $x y z_{i}$ 相对坐标系 $x y z_{i-1}$ 的齐次变换矩阵

位姿有 6 个自由度，所以可以对应 4 个基础 T 矩阵，分为两组：1 个**位移矩阵**，3 个向量组成的**旋转矩阵**。共 12 个有效参数，他们之间按顺序搭配相乘可算出 T 矩阵。

### D-H 法

在每个连杆上都固定一个坐标系，然后用 **4x4 的齐次变换矩阵**描述两个连杆的空间关系，然后依次变换可最终推导出末端执行器相对于基坐标系的位姿。

- 关节角$\theta$
- 连杆偏移$d$
- 连杆长度$a$ 
- 连杆扭转角 $\alpha$



### 标准 DH（SDH）& 改进 DH（SDH）

SDH 方法将连杆 i 的坐标系固定在连杆的远端，MDH 方法把连杆 i 的坐标系固定在连杆的近端。

## 瞬态运动学

从“正运动学”公式推导出“瞬时运动学”公式
$\vec{x}=f(\vec{q})$ ：$\vec{x}$ 表示末端位置和朝向；$\vec{q}$ 表示关节位置。

“瞬时运动学”求解的是从关节空间到操作空间的速度映射，速度描述的是短时间内的位置变化，即**位置对时间的导数**。

$$
\begin{align*}
&\frac{d \vec{x}}{d t}=\frac{d f(\vec{q})}{d t}=\frac{d f(\vec{q})}{d \vec{q}} \cdot \frac{d \vec{q}}{d t} \\&\dot{x}=\frac{d \vec{x}}{d \vec{q}} \cdot \dot{q}
\end{align*}
$$
