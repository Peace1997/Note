
目前，基于深度强化学习方法，主要从以下两个方向去研究设计导弹的运动控制器：
- **端到端的运动控制**：通过深度强化学习方法直接控制导弹的推进器
- **RL + PID**：两种结合思路
	- **RL在线调整 PID 控制器参数**：将 PID 控制器作为基准控制结构，通过深度强化学习在线调整 PID 控制器参数，即RL作为超参数优化的工具。
	- **PID控制与RL的联合动作**：将PID控制器的动作输出作为基准动作，深度强化学习在此动作基础上进行微调，即在PID控制基础上叠加RL修正动作。


- [ ] 端到端运动控制训练调参
- [ ] PID 控制器实现制导任务




# 一、端到端运动控制训练调参
**训练总结**
在过去的两周中，继续进行之前的运动控制训练和调参工作，与之前的训练版本相比，在控制导弹头部与地面发生碰撞方面有了一定的进展。然而，仅有极少数的回合表现出了智能行为，还没有成功实现精确制导任务。此外，模型表现很不稳定，在测试过程中经常出现任务失败的情况。

目前相对较优的一次测试回合的关键帧截图：
![[box2d23.png|400]]
![[box2d22.png|400]]
![[box2d25.png|400]]
![[box2d24.png|400]]

重要超参数记录：

| 超参数                           | 取值                                 |
| -------------------------------- | ------------------------------------ |
| lr                               | 0.0001                               |
| gamma                            | 0.99                                 |
| batch-size                       | 4000                                 |
| num_workers                      | 1                                    |
| hidden_size                      | [256, 256]                           |
| max_episode_steps                | 800                                  |
| 任务完成奖励                     | 200                                  |
| 任务失败惩罚                     | -100、-50                                 |
| 基于距离奖惩                     | 当前时刻与上一时刻与目标点距离的差值 |
| 能量消耗惩罚                     | -power*（0.3/0.003）                                     |


# 二、 PID控制器

## 1. 基础制导律学习
在惯性制导系统中，常用的制导律包括比例导引（Proportional Guidance）、比例-微分导引（Proportional-Derivative Guidance）和比例-积分-微分导引（Proportional-Integral-Derivative Guidance）。这些导引律是用于计算制导命令的数学算法，以实现导弹或飞行器的精确制导和控制。

1. **比例导引**（Proportional Guidance）：
比例导引是最简单的导引律之一。它根据目标与导弹之间的位置差异来生成制导命令。制导命令的大小与目标与导弹之间的距离成正比。比例导引的数学表达式如下：
$$C = K_p \cdot \delta$$
其中，$C$ 是制导命令，$K_p$是比例增益，$\delta$ 是目标与导弹之间的位置差异（通常是位置矢量的差）。

2. **比例-微分导引**（Proportional-Derivative Guidance）：
比例-微分导引在比例导引的基础上增加了速度差异的考虑。除了目标与导弹之间的位置差异，它还考虑了它们之间的速度差异。这可以提供更快的响应和更好的稳定性。比例-微分导引的数学表达式如下：
$$C = K_p \cdot \delta + K_d \cdot \frac{d\delta}{dt}$$
其中，$C$ 是制导命令，$K_p$ 是比例增益，$K_d$ 是微分增益，$\delta$ 是目标与导弹之间的位置差异，$\frac{d\delta}{dt}$ 是位置差异的导数（速度差异）。

3. **比例-积分-微分导引**（Proportional-Integral-Derivative Guidance）：
比例-积分-微分导引是进一步扩展了比例-微分导引的导引律。除了位置差异和速度差异，它还考虑了时间上的积分效应，用于消除系统的静态误差。比例-积分-微分导引的数学表达式如下：
$$C = K_p \cdot \delta + K_i \cdot \int \delta \, dt + K_d \cdot \frac{d\delta}{dt}$$
其中，$C$ 是制导命令，$K_p$ 是比例增益，$K_i$ 是积分增益，$K_d$ 是微分增益，$\delta$ 是目标与导弹之间的位置差异，$\int \delta \, dt$ 是位置差异的时间积分，$\frac{d\delta}{dt}$ 是位置差异的导数（速度差异）。

## 2. 编码实现 PID 控制器

PID 控制器是一种线性控制器，它主要根据给定值和实际输出值构成控制偏差，然后利用偏差给出合理的控制量。

首先，利用 PID 方法实现一个简单样例：将质点从初始点到达特点目标点：
![[Pasted image 20230528093236.png|300]]
![[Pasted image 20230528093310.png|300]]

参照基础制导律以及 PID 控制器实现的相关实例，通过 Python 编码实现与本任务相关的 PID 导弹控制结构。通过设计相关的偏差函数和手动调整增益参数，下面是表现较好的关键帧截图：
![[Pasted image 20230528113132.png|400]]
![[Pasted image 20230528113206.png|400]]
![[Pasted image 20230528113235.png|400]]


下周任务：
- [ ] 实现RL与PID控制器的结合
- [ ] 继续进行端到到运动控制的训练调参